# Monitoring Guide for Online Migration with Databricks

## How to read status server

Assuming the entry in config looks like this:
  <pre>
  <code>
  ...
  "status": {
    "serverName": "statusServer",
    "database": "database_name",
    "collection": "migration_status",
    "throughput": 4000
    },
  ...
  </code>
  </pre>

1. Goto the portal UI of the Cosmos DB Nosql Server for statusServer
2. In the data explorer find the databae named database_status
3. Within the db database_status look for the collection migration_status
4. Now run the query: select * from c where c.collection = “target_collection_name”
5. The result will look like this:
  <pre>
  <code>
  ...
  {  

    "id": "38804944-2c30-486c-85b6-76309e7df9d8",  
    "migrationType": "BULK_COPY",  
    "parentId": null,  
    "sourceName": "sourceDBServer",  
    "database": "sourceDBName",  
    "collection": "sourceCollection",  
    "sessionId": "e0e1cc6d-1c47-4705-be5a-533d89a2df6d",  
    "timestamp": "Wed Aug 02 17:22:23 UTC 2023",  
    "streamingToIntermediateCheckpoint": "/tmp/streaming/intermediate/1690996943511/ sourceDBName / sourceCollection /",  
    "streamingToDestinationCheckpoint": "/tmp/streaming/destination/1690996943511/ destinationDBName / destinationCollection /",  
    "sourceDocumentCount": 825583,  
    "destinationDocumentCountAfterBulkCopy": 825583,  
    "destinationDocumentCountAtEnd": 825583,  
    "finalDocumentCount": 825583,  
    "status": "SUCCESSFUL",  
    "_rid": "cAEQAPZM2WUCAAAAAAAAAA==",  
    "_self": "dbs/cAEQAA==/colls/cAEQAPZM2WU=/docs/cAEQAPZM2WUCAAAAAAAAAA==/",  
    "_etag": "\"0200fdc0-0000-0700-0000-64caa2c40000\"",  
    "_attachments": "attachments/",  
    "_ts": 1691001540  
  }  
  ...
  </code>
  </pre>

The keys which are relevant are: collection, sourceDocumentCount, … finalDocumentCount, status.  
If the status is successful and the finalDocumentCount matches sourceDocumentCount, then the job is successful.  
If the result looks like this:
  <pre>
  <code>
  ...
  {  
     "id": "af65102d-d073-44c4-b801-536aa6fdc2a0",  
     "migrationType": "BULK_COPY",  
     "parentId": null,  
     "sourceName": "sourceDBServer",  
     "database": "sourceDBName",  
     "collection": "sourceCollection",  
     "sessionId": "e0e1cc6d-1c47-4705-be5a-533d89a2df6d",  
     "timestamp": "Wed Aug 02 17:22:48 UTC 2023",  
     "streamingToIntermediateCheckpoint": "/tmp/streaming/intermediate/1690996943511/ sourceDBName / sourceCollection /",  
     "streamingToDestinationCheckpoint": "/tmp/streaming/destination/1690996943511/ destinationDBName / destinationCollection /",  
     "sourceDocumentCount": 874,  
     "destinationDocumentCountAfterBulkCopy": 862,  
     "destinationDocumentCountAtEnd": -1,  
     "finalDocumentCount": 0,  
     "status": "PARTIAL",  
     "_rid": "cAEQAPZM2WUFAAAAAAAAAA==",  
     "_self": "dbs/cAEQAA==/colls/cAEQAPZM2WU=/docs/cAEQAPZM2WUFAAAAAAAAAA==/",  
     "_etag": "\"0200724d-0000-0700-0000-64ca91ea0000\"",  
     "_attachments": "attachments/",  
     "_ts": 1690997226  
  }  
  ...
  </code>
  </pre>
